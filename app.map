{"version":3,"sources":["js/setup.js","templates/blog.js","templates/edit.js","templates/newpost.js","templates/sidebar.js","js/models/blog.js","js/collections/blogposts.js","js/views/blogview.js","js/views/sidebarview.js","js/views/editview.js","js/views/newview.js","js/router/router.js","js/index.js"],"sourcesContent":["var AppTemplates = {};\n","AppTemplates['blog'] = Handlebars.template({\"compiler\":[6,\">= 2.0.0-beta.1\"],\"main\":function(depth0,helpers,partials,data) {\n    var helper, alias1=helpers.helperMissing, alias2=\"function\", alias3=this.escapeExpression;\n\n  return \"<article>\\n    <header>\\n        <h1 class=\\\"title\\\">\"\n    + alias3(((helper = (helper = helpers.title || (depth0 != null ? depth0.title : depth0)) != null ? helper : alias1),(typeof helper === alias2 ? helper.call(depth0,{\"name\":\"title\",\"hash\":{},\"data\":data}) : helper)))\n    + \"</h1>\\n    </header>\\n    <section>\\n        <p class=\\\"date\\\">posted on: \"\n    + alias3(((helper = (helper = helpers.createDate || (depth0 != null ? depth0.createDate : depth0)) != null ? helper : alias1),(typeof helper === alias2 ? helper.call(depth0,{\"name\":\"createDate\",\"hash\":{},\"data\":data}) : helper)))\n    + \"</p>\\n        <p class=\\\"post\\\">\"\n    + alias3(((helper = (helper = helpers.post || (depth0 != null ? depth0.post : depth0)) != null ? helper : alias1),(typeof helper === alias2 ? helper.call(depth0,{\"name\":\"post\",\"hash\":{},\"data\":data}) : helper)))\n    + \"</p>\\n    </section>\\n    <a href=\\\"#\"\n    + alias3(((helper = (helper = helpers._id || (depth0 != null ? depth0._id : depth0)) != null ? helper : alias1),(typeof helper === alias2 ? helper.call(depth0,{\"name\":\"_id\",\"hash\":{},\"data\":data}) : helper)))\n    + \"/edit\\\"><button class=\\\"editbutton\\\">Edit Post</button></a>\\n</article>\\n\";\n},\"useData\":true});","AppTemplates['edit'] = Handlebars.template({\"compiler\":[6,\">= 2.0.0-beta.1\"],\"main\":function(depth0,helpers,partials,data) {\n    var helper, alias1=helpers.helperMissing, alias2=\"function\", alias3=this.escapeExpression;\n\n  return \"<form class=\\\"edit\\\">\\n    <input type=\\\"text\\\" name=\\\"title\\\" value=\\\"\"\n    + alias3(((helper = (helper = helpers.title || (depth0 != null ? depth0.title : depth0)) != null ? helper : alias1),(typeof helper === alias2 ? helper.call(depth0,{\"name\":\"title\",\"hash\":{},\"data\":data}) : helper)))\n    + \"\\\" class=\\\"title\\\">\\n    <textarea name=\\\"post\\\" class=\\\"post\\\">\"\n    + alias3(((helper = (helper = helpers.post || (depth0 != null ? depth0.post : depth0)) != null ? helper : alias1),(typeof helper === alias2 ? helper.call(depth0,{\"name\":\"post\",\"hash\":{},\"data\":data}) : helper)))\n    + \"</textarea>\\n    <button class=\\\"save\\\">Save</button>\\n    <button class=\\\"delete\\\">Delete</button>\\n</form>\\n\";\n},\"useData\":true});","AppTemplates['newpost'] = Handlebars.template({\"compiler\":[6,\">= 2.0.0-beta.1\"],\"main\":function(depth0,helpers,partials,data) {\n    return \"<form class=\\\"new\\\">\\n    <input type=\\\"text\\\" name=\\\"title\\\" class=\\\"title\\\" placeholder=\\\"Title\\\">\\n    <textarea name=\\\"body\\\" class=\\\"post\\\" placeholder=\\\"body\\\"></textarea>\\n    <button class=\\\"save\\\">Submit</button>\\n</form>\\n\";\n},\"useData\":true});","AppTemplates['sidebar'] = Handlebars.template({\"1\":function(depth0,helpers,partials,data,blockParams) {\n    var stack1, alias1=this.lambda, alias2=this.escapeExpression;\n\n  return \"        <li>\\n            <a href=\\\"#\"\n    + alias2(alias1(((stack1 = blockParams[0][0]) != null ? stack1._id : stack1), depth0))\n    + \"\\\">\\n                <p class=\\\"title\\\">\"\n    + alias2(alias1(((stack1 = blockParams[0][0]) != null ? stack1.title : stack1), depth0))\n    + \"</p>\\n                <p class=\\\"post\\\">\"\n    + alias2(alias1(((stack1 = blockParams[0][0]) != null ? stack1.post : stack1), depth0))\n    + \"</p>\\n                <p class=\\\"date\\\">\"\n    + alias2(alias1(((stack1 = blockParams[0][0]) != null ? stack1.createDate : stack1), depth0))\n    + \"</p>\\n            </a>\\n        </li>\\n\";\n},\"compiler\":[6,\">= 2.0.0-beta.1\"],\"main\":function(depth0,helpers,partials,data,blockParams) {\n    var stack1;\n\n  return \"<ul>\\n\"\n    + ((stack1 = helpers.each.call(depth0,depth0,{\"name\":\"each\",\"hash\":{},\"fn\":this.program(1, data, 1, blockParams),\"inverse\":this.noop,\"data\":data,\"blockParams\":blockParams})) != null ? stack1 : \"\")\n    + \"    <li class=\\\"newbutton\\\">\\n        <a href=\\\"#new\\\">\\n            <button>New</button>\\n        </a>\\n    </li>\\n</ul>\\n\";\n},\"useData\":true,\"useBlockParams\":true});","var Blog = Backbone.Model.extend({\n  idAttribute: '_id',\n  defaults: {\n    title: '',\n    post: '',\n    createDate: null,\n    editDate: null,\n  },\n});\n","var BlogPosts = Backbone.Collection.extend({\n  model: Blog,\n  url: 'http://tiny-lr.herokuapp.com/collections/co-blog'\n});\n","var BlogView = Backbone.View.extend({\n\n  template: AppTemplates.blog,\n\n  initialize: function() {\n    this.listenTo(this.collection, 'add sync change', this.render);\n    this.render();\n  },\n\n  render: function() {\n    var data = {};\n    if (this.model) {\n      data = this.model.toJSON();\n    }\n\n    var html = this.template(data);\n    this.$el.html(html);\n\n    console.info('render');\n\n    return this;\n  },\n});\n","var SidebarView = Backbone.View.extend({\n\n  template: AppTemplates.sidebar,\n\n  initialize: function() {\n    this.listenTo(this.collection, 'add reset sync change', this.render);\n    this.render();\n  },\n\n  render: function() {\n    var html = this.template(this.collection.toJSON());\n    this.$el.html(html);\n\n    // this.collection.sortBy('createDate');\n\n    console.info('render');\n\n    return this;\n  },\n});\n","var EditView = Backbone.View.extend({\n  template: AppTemplates.edit,\n\n  events: {\n    'click .save': 'save',\n    'click .delete': 'delete',\n  },\n\n  initialize: function() {\n    this.render();\n  },\n\n  render: function() {\n    var data = {};\n    if (this.model) {\n      data = this.model.toJSON();\n    }\n\n    var html = this.template(data);\n    this.$el.html(html);\n\n    console.info('render');\n\n    return this;\n  },\n\n  save: function(ev) {\n    ev.preventDefault();\n    var title = this.$el.find('.title').val();\n    var post = this.$el.find('.post').val();\n    var date = new Date();\n    var dateString = date.getMonth() + ' ' + date.getDate() + ', ' + date.getFullYear();\n    this.model.save({title: title, post: post, editDate: dateString}).then(function() {\n      router.navigate('this.model.id', {trigger: true});\n    });\n  },\n\n  delete: function(ev) {\n    ev.preventDefault();\n    this.model.destroy().then(function() {\n      router.navigate('', {trigger: true});\n    });\n  },\n});\n","var NewView = Backbone.View.extend({\n  template: AppTemplates.newpost,\n\n  events: {\n    'submit form': 'save',\n  },\n\n  initialize: function() {\n    this.listenTo(this.collection, 'add reset sync', this.render);\n    this.render();\n  },\n\n  render: function() {\n    this.$el.html(this.template());\n\n    console.info('render');\n\n    return this;\n  },\n\n  save: function(ev) {\n    ev.preventDefault();\n    var title = this.$el.find('.title').val();\n    var post = this.$el.find('.post').val();\n    var date = new Date();\n    var createString = date.getMonth() + ' ' + date.getDate() + ', ' + date.getFullYear();\n\n    var model = this.collection.add({title: title, post: post, createDate: createString,});\n    model.save().then(function() {\n      window.location = '#' + model.id;\n    });\n  },\n\n});\n","var AppRouter = Backbone.Router.extend({\n  initialize: function() {\n    this.collection = new BlogPosts();\n    this.collection.fetch();\n    this.sidebar = new SidebarView({collection: this.collection});\n    $('#sidebar').html(this.sidebar.render().el);\n  },\n\n  routes: {\n    '(#)': 'index',\n    new: 'newBlog',\n    ':id': 'readPost',\n    ':id/edit': 'edit',\n  },\n\n  index: function() {\n    var _this = this;\n\n    var attachDetail = function() {\n      var model = _this.collection.first();\n      _this.indexPost = new BlogView({model: model});\n      $('#target').html(_this.indexPost.render().el);\n    };\n\n    attachDetail();\n    this.listenTo(this.collection, 'sync', attachDetail);\n  },\n\n  readPost: function(id) {\n    var _this = this;\n    if (this.indexPost) {\n      this.indexPost.remove();\n    }\n\n    if (this.currentPost) {\n      this.currentPost.remove();\n    }\n\n    if (this.editView) {\n      this.editView.remove();\n    }\n\n    if (this.newPostView) {\n      this.newPostView.remove();\n    }\n\n    var attachDetail = function() {\n      var model = _this.collection.get(id);\n      _this.currentPost = new BlogView({model: model});\n      $('#target').html(_this.currentPost.render().el);\n    };\n\n    attachDetail();\n    this.listenTo(this.collection, 'sync', attachDetail);\n  },\n\n  edit: function(id) {\n    var _this = this;\n    if (this.indexPost) {\n      this.indexPost.remove();\n    }\n\n    if (this.currentPost) {\n      this.currentPost.remove();\n    }\n\n    if (this.newPostView) {\n      this.newPostView.remove();\n    }\n\n    var showEdit = function() {\n      var model = _this.collection.get(id);\n      this.editView = new EditView({model: model});\n      $('#target').html(this.editView.render().el);\n    };\n\n    showEdit();\n    this.listenTo(this.collection, 'sync', showEdit);\n  },\n\n  newBlog: function() {\n    if (this.indexPost) {\n      this.indexPost.remove();\n    }\n\n    if (this.editView) {\n      this.editView.remove();\n    }\n\n    if (this.newPostView) {\n      this.newPostView.remove();\n    }\n\n    if (this.currentPost) {\n      this.currentPost.remove();\n    }\n\n    this.newPostView = new NewView({collection: this.collection});\n    $('#target').html(this.newPostView.render().el);\n  },\n\n});\n","var router = new AppRouter();\n\nBackbone.history.start();\n"],"names":[],"mappings":"AAAA;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;;ACDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;;ACHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrGA;AACA;AACA;","file":"app.js"}